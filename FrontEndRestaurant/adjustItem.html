<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adjust Item</title>
    <link rel="stylesheet" href="itemAdjust.css">
</head>
<body>
    <header>
        <!-- NAVIGATION BAR -->
        <h1 class="logo_name">ROCKETMEAL</h1>
        <div>
            <p class="logo_description">30 minutes</p>
            <ul class="navigation_bar">
                <li class="nav_list"><a href="">Login</a></li>
                <li class="nav_list"><a href="">About Us</a></li>
                <li class="nav_list"><a href="">Food Categories</a></li>
                <li class="nav_list"><a href="index.html">Home</a></li>
            </ul>
        </div>
    </header>

    <main>
        <section class="menu-section">
            <h2 style="text-align: center; margin-top: 45px; color: white;">Add New Items or Edit Items From Your Menu</h2>
            <h3 style="text-align: left;margin-top: 48px;color: #D7CFCF;margin-left: 30px;">Full menu</h3>
            <div class="menu-grid">
            </div>
        </section>
        <div class="button-container">
            <button class="custom-button" type="button" onclick="window.location.href='addItem.html'">Add Items</button>
            <button class="custom-button" type="button">Done</button>
        </div>
    </main>

    <footer>
        <p>Are you a partner of ROCKETMEAL? <a href="#">Click here to go to partner's page</a></p>
        <p>&copy; 2024 ROCKETMEAL</p>
    </footer>

    <script>

        document.addEventListener('DOMContentLoaded', () => {
            const restaurantId = JSON.parse(localStorage.getItem('restaurantId'));
            if(restaurantId)
                getDish();
                function getDish() {
                fetch(`http://localhost:8081/restaurants/profile?id=${restaurantId}`)
                    .then(response => response.json())
                    .then(data => {
                        displayDish(data.dishDtoList);
                    })
                    .catch(error => console.error('Error fetching dishes:', error));
                }

                function displayDish(dishDtoList){
                    const menuGrid = document.querySelector(".menu-grid");

                    dishDtoList.forEach(dish => {
                        const dishItem = document.createElement("div");
                        dishItem.className = "food-item";
                        dishItem.setAttribute("data-id", dish.id);
                        dishItem.setAttribute("data-name", dish.name);
                        dishItem.setAttribute("data-description", dish.description);
                        dishItem.setAttribute("data-price", dish.price); 
                        const data = dish.image;

                        const url = 'data:image/png;base64,' + data;

                        dishItem.innerHTML = `
                            <img src="${url}" alt="">
                            <button class="threeDotsButton" onclick="editItem(this)">
                                <span style="position: relative; top: -5px;">...</span>
                            </button>
                            <div class="food-details">
                                <div class="food-name">${dish.name}</div>
                                <div class="food-price">$${dish.price}</div>
                            </div>
                        `;

                        menuGrid.appendChild(dishItem);
                    });
                }
        });

        function editItem(button) {
            const foodItem = button.closest('.food-item');
            const itemId = foodItem.dataset.id;

            localStorage.setItem('itemId', JSON.stringify(itemId));
            window.location.href = 'editItem.html';
        }

    </script>
</body>
</html>
